<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>WebARフォトフレーム</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="versionInfo">IM_v2.1.6</div>

  <div class="container">
    <!-- カメラ映像 -->
    <video id="cameraFeed" autoplay playsinline></video>

    <!-- 撮影結果キャンバス -->
    <canvas id="photoCanvas" class="hidden"></canvas>

    <!-- スタンプ用キャンバス（Fabric.js） -->
    <canvas id="stampCanvas"></canvas>

    <!-- シャッターボタン -->
    <button id="shutterButton" class="control-button" aria-label="シャッター">
      <img id="shutterImage" src="./Assets/shutter_button.png" alt="シャッター" />
    </button>

    <!-- スタンプボタン -->
    <button id="stampButton" class="control-button" aria-label="スタンプ">
      <img src="./Assets/stamp_button.png" alt="" style="width:70%;height:70%;object-fit:contain;pointer-events:none;">
    </button>

    <!-- カメラ切り替えボタン -->
    <button id="cameraToggleButton" class="control-button" aria-label="カメラ切り替え">
      <img src="./Assets/change_button.png" alt="" style="width:70%;height:70%;object-fit:contain;pointer-events:none;">
    </button>

    <!-- カメラ許可メッセージ用モーダル -->
    <div id="permissionModal" class="modal">
      <div class="modal-content">
        <p id="permissionMessage" class="hidden"></p>
        <img id="permissionImage" src="./Assets/StartModal.png" alt="WebARコンテンツ説明" />
        <button id="closeModalButton">OK</button>
      </div>
    </div>

    <!-- 撮影後のプレビューモーダル -->
    <div id="previewModal" class="modal hidden" aria-modal="true" role="dialog">
      <div class="preview-wrap">
        <button id="previewCloseX" class="preview-close" aria-label="閉じる">×</button>
        <img id="previewImage" alt="撮影プレビュー" />
        <div class="preview-actions">
          <button id="previewSaveBtn" class="preview-btn primary">保存する</button>
          <button id="previewShareBtn" class="preview-btn">共有する</button>
          <button id="previewCloseBtn" class="preview-btn danger">閉じる</button>
        </div>
      </div>
    </div>

    <!-- フォトフレーム -->
    <img id="frameTop" src="./Assets/FYOP_AR_flame_top.png" alt="">
    <img id="frameBottom" src="./Assets/FYOP_AR_flame_bottom.png" alt="">

    <!-- スタンプ選択シート -->
    <div id="stampSheet" class="stamp-sheet" aria-modal="true" role="dialog">
      <div class="sheet-grip" aria-hidden="true"></div>
      <button id="sheetCloseX" class="sheet-close-x" aria-label="閉じる">×</button>

      <!-- タブ -->
      <div class="sheet-tabs" id="stampTabs" role="tablist" aria-label="スタンプカテゴリ">
        <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="panel-stamp1" id="tab-stamp1" data-tab="stamp1">Stamp1</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-stamp2" id="tab-stamp2" data-tab="stamp2">Stamp2</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-stamp3" id="tab-stamp3" data-tab="stamp3">Stamp3</button>
      </div>

      <!-- パネル -->
      <div class="sheet-body">
        <div class="stamp-panel" role="tabpanel" id="panel-stamp1" aria-labelledby="tab-stamp1" data-tab="stamp1">
          <button class="stamp-thumb" data-src="./Assets/stamp019.png" aria-label="Stam1-01"><img src="./Assets/stamp019.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp020.png" aria-label="Stam1-02"><img src="./Assets/stamp020.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp018.png" aria-label="Stam1-03"><img src="./Assets/stamp018.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp017.png" aria-label="Stam1-04"><img src="./Assets/stamp017.png" alt=""></button>
        </div>
        <div class="stamp-panel active" role="tabpanel" id="panel-stamp2" aria-labelledby="tab-stamp2" data-tab="stamp2">
          <button class="stamp-thumb" data-src="./Assets/stamp001.png" aria-label="Stamp2-01"><img src="./Assets/stamp001.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp002.png" aria-label="Stamp2-02"><img src="./Assets/stamp002.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp003.png" aria-label="Stamp2-03"><img src="./Assets/stamp003.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp004.png" aria-label="Stamp2-04"><img src="./Assets/stamp004.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp005.png" aria-label="Stamp2-05"><img src="./Assets/stamp005.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp006.png" aria-label="Stamp2-06"><img src="./Assets/stamp006.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp007.png" aria-label="Stamp2-07"><img src="./Assets/stamp007.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp008.png" aria-label="Stamp2-08"><img src="./Assets/stamp008.png" alt=""></button>
        </div>
        <div class="stamp-panel" role="tabpanel" id="panel-stamp3" aria-labelledby="tab-stamp3" data-tab="stamp3">
          <button class="stamp-thumb" data-src="./Assets/stamp009.png" aria-label="Stamp3-01"><img src="./Assets/stamp009.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp010.png" aria-label="Stamp3-02"><img src="./Assets/stamp010.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp011.png" aria-label="Stamp3-03"><img src="./Assets/stamp011.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp012.png" aria-label="Stamp3-04"><img src="./Assets/stamp012.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp013.png" aria-label="Stamp3-05"><img src="./Assets/stamp013.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp014.png" aria-label="Stamp3-06"><img src="./Assets/stamp014.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp015.png" aria-label="Stamp3-07"><img src="./Assets/stamp015.png" alt=""></button>
          <button class="stamp-thumb" data-src="./Assets/stamp016.png" aria-label="Stamp3-08"><img src="./Assets/stamp016.png" alt=""></button>
        </div>
      </div>
    </div>

    <!-- スタンプ長押し用フリックアクションダイヤル -->
    <div id="stampActionDial" class="hidden" aria-hidden="true">
      <button data-action="delete"      class="dial-btn dial-right">削除</button>
      <button data-action="front"       class="dial-btn dial-up">前面へ</button>
      <button data-action="back"        class="dial-btn dial-down">背面へ</button>
      <button data-action="lock-toggle" class="dial-btn dial-left">ロック</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <script src="script.js"></script>
</body>
</html>