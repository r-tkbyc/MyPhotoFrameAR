<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>WebARフォトフレーム</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="versionInfo">v1.6.0</div>

  <div class="container">
    <!-- カメラ映像 -->
    <video id="cameraFeed" autoplay playsinline></video>

    <!-- 撮影結果キャンバス（最初は非表示） -->
    <canvas id="photoCanvas" class="hidden"></canvas>

    <!-- ▼ スタンプ用キャンバス（Fabric.js／カメラの上、フレームの下） -->
    <canvas id="stampCanvas"></canvas>

    <!-- シャッターボタン（画像のみ） -->
    <button id="shutterButton" class="control-button" aria-label="シャッター">
      <img id="shutterImage" src="./Assets/shutter_button.png" alt="シャッター" />
    </button>

    <!-- スタンプボタン（シャッターの左） -->
    <button id="stampButton" class="control-button" aria-label="スタンプ">
      <img src="./Assets/stamp_button.png" alt="" style="width:70%;height:70%;object-fit:contain;pointer-events:none;">
    </button>

    <!-- カメラ許可メッセージ用モーダル -->
    <div id="permissionModal" class="modal">
      <div class="modal-content">
        <p id="permissionMessage"></p>
        <button id="closeModalButton">OK</button>
      </div>
    </div>

    <!-- 撮影後のプレビューモーダル -->
    <div id="previewModal" class="modal hidden" aria-modal="true" role="dialog">
      <div class="preview-wrap">
        <button id="previewCloseX" class="preview-close" aria-label="閉じる">×</button>
        <img id="previewImage" alt="撮影プレビュー" />
        <div class="preview-actions">
          <button id="previewSaveBtn" class="preview-btn primary">保存する</button>
          <button id="previewShareBtn" class="preview-btn">共有する</button>
          <button id="previewCloseBtn" class="preview-btn danger">閉じる</button>
        </div>
      </div>
    </div>

    <!-- フォトフレーム（見た目のオーバーレイ用） -->
    <img id="frameTop" src="./Assets/frame_moon_top.png" alt="">
    <img id="frameBottom" src="./Assets/frame_moon_bottm.png" alt="">

    <!-- ▼ 下から出る半透明のスタンプ選択シート -->
    <div id="stampSheet" class="stamp-sheet" aria-modal="true" role="dialog">
      <div class="sheet-grip" aria-hidden="true"></div>

      <!-- ★ 右上の × ボタンを追加 -->
      <button id="sheetCloseX" class="sheet-close-x" aria-label="閉じる">×</button>

      <!-- タブ見出し -->
      <div class="sheet-tabs" id="stampTabs" role="tablist" aria-label="スタンプカテゴリ">
        <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="panel-stamp1" id="tab-stamp1" data-tab="stamp1">Stamp1</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-stamp2" id="tab-stamp2" data-tab="stamp2">Stamp2</button>
        <!-- 例: タブを増やす場合は↓をコピペ
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-stamp3" id="tab-stamp3" data-tab="stamp3">Stamp3</button>
        -->
      </div>

      <!-- タブの中身 -->
      <div class="sheet-body">
        <!-- Stamp1 パネル -->
        <div class="stamp-panel active" role="tabpanel" id="panel-stamp1" aria-labelledby="tab-stamp1" data-tab="stamp1">
          <!-- ここに Stamp1 グループのスタンプサムネイルを置く -->
          <button class="stamp-thumb" data-src="./Assets/stamp_f.png" aria-label="Stamp1-01">
            <img src="./Assets/stamp_f.png" alt="">
          </button>
          <button class="stamp-thumb" data-src="./Assets/stamp_y.png" aria-label="Stamp1-02">
            <img src="./Assets/stamp_y.png" alt="">
          </button>
          <button class="stamp-thumb" data-src="./Assets/stamp_o.png" aria-label="Stamp1-03">
            <img src="./Assets/stamp_o.png" alt="">
          </button>
          <button class="stamp-thumb" data-src="./Assets/stamp_p.png" aria-label="Stamp1-04">
            <img src="./Assets/stamp_p.png" alt="">
          </button>
          <!-- 必要なだけ追加 -->
        </div>

        <!-- Stamp2 パネル -->
        <div class="stamp-panel" role="tabpanel" id="panel-stamp2" aria-labelledby="tab-stamp2" data-tab="stamp2">
          <button class="stamp-thumb" data-src="./Assets/stamp_logo.png" aria-label="Stamp2-01">
            <img src="./Assets/stamp_logo.png" alt="">
          </button>
          <button class="stamp-thumb" data-src="./Assets/stamp_hand.png" aria-label="Stamp2-02">
            <img src="./Assets/stamp_hand.png" alt="">
          </button>
          <!-- 必要なだけ追加 -->
        </div>

        <!-- 例: パネルを増やす場合は↓をコピペして data-tab / id / aria を揃える
        <div class="stamp-panel" role="tabpanel" id="panel-stamp3" aria-labelledby="tab-stamp3" data-tab="stamp3">
          <button class="stamp-thumb" data-src="./Assets/stamps/stamp3_01.png"><img src="./Assets/stamps/stamp3_01.png" alt=""></button>
        </div>
        -->
      </div>

      <button id="sheetCloseBtn" class="sheet-close" aria-label="閉じる">閉じる</button>
    </div>

    <!-- ▼ スタンプ長押し用：フリックアクションダイヤル -->
    <div id="stampActionDial" class="hidden" aria-hidden="true">
      <button data-action="delete"      class="dial-btn dial-right">削除</button>
      <button data-action="front"       class="dial-btn dial-up">前面へ</button>
      <button data-action="back"        class="dial-btn dial-down">背面へ</button>
      <button data-action="lock-toggle" class="dial-btn dial-left">ロック</button>
    </div>
  </div>

  <!-- Fabric.js（すでに読み込み済みでなければ） -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
